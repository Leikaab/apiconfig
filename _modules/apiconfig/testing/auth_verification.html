

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>apiconfig.testing.auth_verification &mdash; apiconfig 0.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=23fbc494" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=e259d695"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            apiconfig
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installing-with-pip">Installing with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#installing-with-poetry">Installing with Poetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#development-installation">Development Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#verifying-installation">Verifying Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#basic-configuration">Basic Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#authentication">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started.html#api-key-authentication">API Key Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started.html#basic-authentication">Basic Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started.html#bearer-token-authentication">Bearer Token Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started.html#custom-authentication">Custom Authentication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#loading-configuration">Loading Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started.html#from-environment-variables">From Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting_started.html#from-a-file">From a File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#using-with-http-clients">Using with HTTP Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide.html#configuration-management">Configuration Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#merging-configurations">Merging Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#configuration-providers">Configuration Providers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../user_guide.html#environment-variables-provider">Environment Variables Provider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../user_guide.html#file-provider">File Provider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../user_guide.html#memory-provider">Memory Provider</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide.html#authentication-strategies">Authentication Strategies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#api-key-authentication">API Key Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#basic-authentication">Basic Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#bearer-authentication">Bearer Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#custom-authentication">Custom Authentication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide.html#token-management">Token Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#refresh-tokens">Refresh Tokens</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide.html#token-storage">Token Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide.html#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../auth_refresh_guide.html">Authentication Refresh Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../auth_refresh_guide.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../auth_refresh_guide.html#basic-refresh-pattern">Basic Refresh Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../auth_refresh_guide.html#integration-with-http-clients">Integration with HTTP Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../auth_refresh_guide.html#custom-auth-strategy-with-refresh">Custom Auth Strategy with Refresh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../auth_refresh_guide.html#error-handling">Error Handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../crudclient_integration.html">CrudClient Integration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../crudclient_integration.html#basic-integration">Basic Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../crudclient_integration.html#advanced-integration-with-custom-configuration">Advanced Integration with Custom Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../crudclient_integration.html#tripletex-example">Tripletex Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Real-World Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples.html#jsonplaceholder-api">JSONPlaceholder API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples.html#fiken-api-oauth2">Fiken API (OAuth2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples.html#tripletex-api-api-key-token">Tripletex API (API Key + Token)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples.html#oneflow-api-api-key">OneFlow API (API Key)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples.html#creating-a-reusable-api-client">Creating a Reusable API Client</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#setting-up-the-development-environment">Setting Up the Development Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#clone-the-repository">Clone the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#using-dev-containers-recommended">Using Dev Containers (Recommended)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#manual-setup">Manual Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#running-tests">Running Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#unit-tests">Unit Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#integration-tests">Integration Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#coverage">Coverage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#code-style-and-quality">Code Style and Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#branching-strategy">Branching Strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#commit-message-guidelines">Commit Message Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#pull-request-process">Pull Request Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#documentation">Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../contributing.html#building-the-documentation">Building the Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#release-process">Release Process</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/auth.html">apiconfig.auth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy"><code class="docutils literal notranslate"><span class="pre">AuthStrategy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.__init__"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.can_refresh"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.can_refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.get_refresh_callback"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.get_refresh_callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.is_expired"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.is_expired()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.prepare_request_headers"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.prepare_request_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.prepare_request_params"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.prepare_request_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.AuthStrategy.refresh"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.refresh()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BasicAuth"><code class="docutils literal notranslate"><span class="pre">BasicAuth</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BasicAuth.__init__"><code class="docutils literal notranslate"><span class="pre">BasicAuth.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BasicAuth.prepare_request_headers"><code class="docutils literal notranslate"><span class="pre">BasicAuth.prepare_request_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BasicAuth.prepare_request_params"><code class="docutils literal notranslate"><span class="pre">BasicAuth.prepare_request_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BasicAuth.username"><code class="docutils literal notranslate"><span class="pre">BasicAuth.username</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BasicAuth.password"><code class="docutils literal notranslate"><span class="pre">BasicAuth.password</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth"><code class="docutils literal notranslate"><span class="pre">BearerAuth</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.__init__"><code class="docutils literal notranslate"><span class="pre">BearerAuth.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.can_refresh"><code class="docutils literal notranslate"><span class="pre">BearerAuth.can_refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.is_expired"><code class="docutils literal notranslate"><span class="pre">BearerAuth.is_expired()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.prepare_request_headers"><code class="docutils literal notranslate"><span class="pre">BearerAuth.prepare_request_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.prepare_request_params"><code class="docutils literal notranslate"><span class="pre">BearerAuth.prepare_request_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.refresh"><code class="docutils literal notranslate"><span class="pre">BearerAuth.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.BearerAuth.access_token"><code class="docutils literal notranslate"><span class="pre">BearerAuth.access_token</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.ApiKeyAuth"><code class="docutils literal notranslate"><span class="pre">ApiKeyAuth</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.ApiKeyAuth.prepare_request_headers"><code class="docutils literal notranslate"><span class="pre">ApiKeyAuth.prepare_request_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.ApiKeyAuth.prepare_request_params"><code class="docutils literal notranslate"><span class="pre">ApiKeyAuth.prepare_request_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.ApiKeyAuth.api_key"><code class="docutils literal notranslate"><span class="pre">ApiKeyAuth.api_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.ApiKeyAuth.header_name"><code class="docutils literal notranslate"><span class="pre">ApiKeyAuth.header_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.ApiKeyAuth.param_name"><code class="docutils literal notranslate"><span class="pre">ApiKeyAuth.param_name</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth"><code class="docutils literal notranslate"><span class="pre">CustomAuth</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.__init__"><code class="docutils literal notranslate"><span class="pre">CustomAuth.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.can_refresh"><code class="docutils literal notranslate"><span class="pre">CustomAuth.can_refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.create_api_key_custom"><code class="docutils literal notranslate"><span class="pre">CustomAuth.create_api_key_custom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.create_session_token_custom"><code class="docutils literal notranslate"><span class="pre">CustomAuth.create_session_token_custom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.is_expired"><code class="docutils literal notranslate"><span class="pre">CustomAuth.is_expired()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.prepare_request"><code class="docutils literal notranslate"><span class="pre">CustomAuth.prepare_request()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.prepare_request_headers"><code class="docutils literal notranslate"><span class="pre">CustomAuth.prepare_request_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.prepare_request_params"><code class="docutils literal notranslate"><span class="pre">CustomAuth.prepare_request_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.CustomAuth.refresh"><code class="docutils literal notranslate"><span class="pre">CustomAuth.refresh()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/auth.html#auth-strategy-refresh-interface">Auth Strategy Refresh Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.base.AuthStrategy.can_refresh"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.can_refresh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.base.AuthStrategy.refresh"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.refresh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.base.AuthStrategy.is_expired"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.is_expired()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#apiconfig.auth.base.AuthStrategy.get_refresh_callback"><code class="docutils literal notranslate"><span class="pre">AuthStrategy.get_refresh_callback()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/auth.html#refresh-callback-integration">Refresh Callback Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/config.html">apiconfig.config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig"><code class="docutils literal notranslate"><span class="pre">ClientConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.hostname"><code class="docutils literal notranslate"><span class="pre">ClientConfig.hostname</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.version"><code class="docutils literal notranslate"><span class="pre">ClientConfig.version</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.headers"><code class="docutils literal notranslate"><span class="pre">ClientConfig.headers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.timeout"><code class="docutils literal notranslate"><span class="pre">ClientConfig.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.retries"><code class="docutils literal notranslate"><span class="pre">ClientConfig.retries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.auth_strategy"><code class="docutils literal notranslate"><span class="pre">ClientConfig.auth_strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.log_request_body"><code class="docutils literal notranslate"><span class="pre">ClientConfig.log_request_body</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.log_response_body"><code class="docutils literal notranslate"><span class="pre">ClientConfig.log_response_body</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.__init__"><code class="docutils literal notranslate"><span class="pre">ClientConfig.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id0"><code class="docutils literal notranslate"><span class="pre">ClientConfig.auth_strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.base_url"><code class="docutils literal notranslate"><span class="pre">ClientConfig.base_url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id1"><code class="docutils literal notranslate"><span class="pre">ClientConfig.headers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id2"><code class="docutils literal notranslate"><span class="pre">ClientConfig.hostname</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id3"><code class="docutils literal notranslate"><span class="pre">ClientConfig.log_request_body</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id4"><code class="docutils literal notranslate"><span class="pre">ClientConfig.log_response_body</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.merge"><code class="docutils literal notranslate"><span class="pre">ClientConfig.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ClientConfig.merge_configs"><code class="docutils literal notranslate"><span class="pre">ClientConfig.merge_configs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id5"><code class="docutils literal notranslate"><span class="pre">ClientConfig.retries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id6"><code class="docutils literal notranslate"><span class="pre">ClientConfig.timeout</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#id7"><code class="docutils literal notranslate"><span class="pre">ClientConfig.version</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ConfigManager"><code class="docutils literal notranslate"><span class="pre">ConfigManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ConfigManager.__init__"><code class="docutils literal notranslate"><span class="pre">ConfigManager.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.ConfigManager.load_config"><code class="docutils literal notranslate"><span class="pre">ConfigManager.load_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/config.html#apiconfig.config.EnvProvider"><code class="docutils literal notranslate"><span class="pre">EnvProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.EnvProvider.__init__"><code class="docutils literal notranslate"><span class="pre">EnvProvider.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.EnvProvider.get"><code class="docutils literal notranslate"><span class="pre">EnvProvider.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.EnvProvider.load"><code class="docutils literal notranslate"><span class="pre">EnvProvider.load()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/config.html#apiconfig.config.FileProvider"><code class="docutils literal notranslate"><span class="pre">FileProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.FileProvider.__init__"><code class="docutils literal notranslate"><span class="pre">FileProvider.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.FileProvider.get"><code class="docutils literal notranslate"><span class="pre">FileProvider.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.FileProvider.load"><code class="docutils literal notranslate"><span class="pre">FileProvider.load()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/config.html#apiconfig.config.MemoryProvider"><code class="docutils literal notranslate"><span class="pre">MemoryProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.MemoryProvider.__init__"><code class="docutils literal notranslate"><span class="pre">MemoryProvider.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/config.html#apiconfig.config.MemoryProvider.get_config"><code class="docutils literal notranslate"><span class="pre">MemoryProvider.get_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/exceptions.html">apiconfig.exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.APIConfigError"><code class="docutils literal notranslate"><span class="pre">APIConfigError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ConfigurationError"><code class="docutils literal notranslate"><span class="pre">ConfigurationError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.AuthenticationError"><code class="docutils literal notranslate"><span class="pre">AuthenticationError</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.AuthenticationError.__init__"><code class="docutils literal notranslate"><span class="pre">AuthenticationError.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.InvalidCredentialsError"><code class="docutils literal notranslate"><span class="pre">InvalidCredentialsError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ExpiredTokenError"><code class="docutils literal notranslate"><span class="pre">ExpiredTokenError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.MissingCredentialsError"><code class="docutils literal notranslate"><span class="pre">MissingCredentialsError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.TokenRefreshError"><code class="docutils literal notranslate"><span class="pre">TokenRefreshError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.AuthStrategyError"><code class="docutils literal notranslate"><span class="pre">AuthStrategyError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.InvalidConfigError"><code class="docutils literal notranslate"><span class="pre">InvalidConfigError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.MissingConfigError"><code class="docutils literal notranslate"><span class="pre">MissingConfigError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ConfigLoadError"><code class="docutils literal notranslate"><span class="pre">ConfigLoadError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ConfigProviderError"><code class="docutils literal notranslate"><span class="pre">ConfigProviderError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.HTTPUtilsError"><code class="docutils literal notranslate"><span class="pre">HTTPUtilsError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.JSONDecodeError"><code class="docutils literal notranslate"><span class="pre">JSONDecodeError</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.JSONDecodeError.__init__"><code class="docutils literal notranslate"><span class="pre">JSONDecodeError.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.JSONEncodeError"><code class="docutils literal notranslate"><span class="pre">JSONEncodeError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.PayloadTooLargeError"><code class="docutils literal notranslate"><span class="pre">PayloadTooLargeError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientError"><code class="docutils literal notranslate"><span class="pre">ApiClientError</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientError.__init__"><code class="docutils literal notranslate"><span class="pre">ApiClientError.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientBadRequestError"><code class="docutils literal notranslate"><span class="pre">ApiClientBadRequestError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientUnauthorizedError"><code class="docutils literal notranslate"><span class="pre">ApiClientUnauthorizedError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientForbiddenError"><code class="docutils literal notranslate"><span class="pre">ApiClientForbiddenError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientNotFoundError"><code class="docutils literal notranslate"><span class="pre">ApiClientNotFoundError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientConflictError"><code class="docutils literal notranslate"><span class="pre">ApiClientConflictError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientUnprocessableEntityError"><code class="docutils literal notranslate"><span class="pre">ApiClientUnprocessableEntityError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientRateLimitError"><code class="docutils literal notranslate"><span class="pre">ApiClientRateLimitError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.ApiClientInternalServerError"><code class="docutils literal notranslate"><span class="pre">ApiClientInternalServerError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/exceptions.html#apiconfig.exceptions.create_api_client_error"><code class="docutils literal notranslate"><span class="pre">create_api_client_error()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/testing.html">apiconfig.testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification"><code class="docutils literal notranslate"><span class="pre">AdvancedAuthVerification</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification.verify_jwt_structure"><code class="docutils literal notranslate"><span class="pre">AdvancedAuthVerification.verify_jwt_structure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification.verify_oauth2_token_format"><code class="docutils literal notranslate"><span class="pre">AdvancedAuthVerification.verify_oauth2_token_format()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification.verify_session_token_format"><code class="docutils literal notranslate"><span class="pre">AdvancedAuthVerification.verify_session_token_format()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_api_key_header"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification.verify_api_key_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_auth_header_format"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification.verify_auth_header_format()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_basic_auth_header"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification.verify_basic_auth_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_bearer_auth_header"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification.verify_bearer_auth_header()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_multiple_auth_headers"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification.verify_multiple_auth_headers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_no_auth_headers"><code class="docutils literal notranslate"><span class="pre">AuthHeaderVerification.verify_no_auth_headers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers"><code class="docutils literal notranslate"><span class="pre">AuthTestHelpers</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers.assert_auth_applied"><code class="docutils literal notranslate"><span class="pre">AuthTestHelpers.assert_auth_applied()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers.assert_no_auth_applied"><code class="docutils literal notranslate"><span class="pre">AuthTestHelpers.assert_no_auth_applied()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers.create_test_auth_headers"><code class="docutils literal notranslate"><span class="pre">AuthTestHelpers.create_test_auth_headers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseAuthStrategyTest"><code class="docutils literal notranslate"><span class="pre">BaseAuthStrategyTest</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseAuthStrategyTest.assertAuthHeaderCorrect"><code class="docutils literal notranslate"><span class="pre">BaseAuthStrategyTest.assertAuthHeaderCorrect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseAuthStrategyTest.setUpClass"><code class="docutils literal notranslate"><span class="pre">BaseAuthStrategyTest.setUpClass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseAuthStrategyTest.strategy"><code class="docutils literal notranslate"><span class="pre">BaseAuthStrategyTest.strategy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.assertProviderLoads"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.assertProviderLoads()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.config_content"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.config_content</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.config_file"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.config_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.config_suffix"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.config_suffix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.env_vars"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.env_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.get_provider_instance"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.get_provider_instance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.provider_class"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.provider_class</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.BaseConfigProviderTest.required_env_vars"><code class="docutils literal notranslate"><span class="pre">BaseConfigProviderTest.required_env_vars</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.MockConfigManager"><code class="docutils literal notranslate"><span class="pre">MockConfigManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.MockConfigManager.__init__"><code class="docutils literal notranslate"><span class="pre">MockConfigManager.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.MockConfigProvider"><code class="docutils literal notranslate"><span class="pre">MockConfigProvider</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.MockConfigProvider.load"><code class="docutils literal notranslate"><span class="pre">MockConfigProvider.load()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.assert_auth_header_correct"><code class="docutils literal notranslate"><span class="pre">assert_auth_header_correct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.assert_client_config_valid"><code class="docutils literal notranslate"><span class="pre">assert_client_config_valid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.assert_provider_loads"><code class="docutils literal notranslate"><span class="pre">assert_provider_loads()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.check_auth_strategy_interface"><code class="docutils literal notranslate"><span class="pre">check_auth_strategy_interface()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.create_auth_credentials"><code class="docutils literal notranslate"><span class="pre">create_auth_credentials()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.create_invalid_client_config"><code class="docutils literal notranslate"><span class="pre">create_invalid_client_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.create_mock_client_config"><code class="docutils literal notranslate"><span class="pre">create_mock_client_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.create_provider_dict"><code class="docutils literal notranslate"><span class="pre">create_provider_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.create_valid_client_config"><code class="docutils literal notranslate"><span class="pre">create_valid_client_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.temp_config_file"><code class="docutils literal notranslate"><span class="pre">temp_config_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/testing.html#apiconfig.testing.temp_env_vars"><code class="docutils literal notranslate"><span class="pre">temp_env_vars()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/utils.html">apiconfig.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/types.html">apiconfig.types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonPrimitive"><code class="docutils literal notranslate"><span class="pre">JsonPrimitive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonValue"><code class="docutils literal notranslate"><span class="pre">JsonValue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonObject"><code class="docutils literal notranslate"><span class="pre">JsonObject</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonList"><code class="docutils literal notranslate"><span class="pre">JsonList</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonEncoder"><code class="docutils literal notranslate"><span class="pre">JsonEncoder</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonDecoder"><code class="docutils literal notranslate"><span class="pre">JsonDecoder</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonSerializerCallable"><code class="docutils literal notranslate"><span class="pre">JsonSerializerCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.JsonDeserializerCallable"><code class="docutils literal notranslate"><span class="pre">JsonDeserializerCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HeadersType"><code class="docutils literal notranslate"><span class="pre">HeadersType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.QueryParamType"><code class="docutils literal notranslate"><span class="pre">QueryParamType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.QueryParamValueType"><code class="docutils literal notranslate"><span class="pre">QueryParamValueType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.DataType"><code class="docutils literal notranslate"><span class="pre">DataType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.ResponseBodyType"><code class="docutils literal notranslate"><span class="pre">ResponseBodyType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpRequestProtocol"><code class="docutils literal notranslate"><span class="pre">HttpRequestProtocol</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpRequestProtocol.method"><code class="docutils literal notranslate"><span class="pre">HttpRequestProtocol.method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpRequestProtocol.url"><code class="docutils literal notranslate"><span class="pre">HttpRequestProtocol.url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpRequestProtocol.headers"><code class="docutils literal notranslate"><span class="pre">HttpRequestProtocol.headers</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpResponseProtocol"><code class="docutils literal notranslate"><span class="pre">HttpResponseProtocol</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpResponseProtocol.status_code"><code class="docutils literal notranslate"><span class="pre">HttpResponseProtocol.status_code</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpResponseProtocol.headers"><code class="docutils literal notranslate"><span class="pre">HttpResponseProtocol.headers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpResponseProtocol.text"><code class="docutils literal notranslate"><span class="pre">HttpResponseProtocol.text</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpResponseProtocol.request"><code class="docutils literal notranslate"><span class="pre">HttpResponseProtocol.request</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpResponseProtocol.reason"><code class="docutils literal notranslate"><span class="pre">HttpResponseProtocol.reason</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod"><code class="docutils literal notranslate"><span class="pre">HttpMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.GET"><code class="docutils literal notranslate"><span class="pre">HttpMethod.GET</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.POST"><code class="docutils literal notranslate"><span class="pre">HttpMethod.POST</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.PUT"><code class="docutils literal notranslate"><span class="pre">HttpMethod.PUT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.DELETE"><code class="docutils literal notranslate"><span class="pre">HttpMethod.DELETE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.PATCH"><code class="docutils literal notranslate"><span class="pre">HttpMethod.PATCH</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.HEAD"><code class="docutils literal notranslate"><span class="pre">HttpMethod.HEAD</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpMethod.OPTIONS"><code class="docutils literal notranslate"><span class="pre">HttpMethod.OPTIONS</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.ConfigDict"><code class="docutils literal notranslate"><span class="pre">ConfigDict</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.ConfigProviderCallable"><code class="docutils literal notranslate"><span class="pre">ConfigProviderCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.AuthCredentials"><code class="docutils literal notranslate"><span class="pre">AuthCredentials</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.TokenStorageStrategy"><code class="docutils literal notranslate"><span class="pre">TokenStorageStrategy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.TokenRefreshCallable"><code class="docutils literal notranslate"><span class="pre">TokenRefreshCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RefreshedTokenData"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RefreshedTokenData.access_token"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.access_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RefreshedTokenData.refresh_token"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.refresh_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RefreshedTokenData.expires_in"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.expires_in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RefreshedTokenData.token_type"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.token_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RefreshedTokenData.scope"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.scope</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id0"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.access_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id1"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.refresh_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id2"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.expires_in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id3"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.token_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id4"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.scope</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.TokenRefreshResult"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.TokenRefreshResult.token_data"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.token_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#apiconfig.types.TokenRefreshResult.config_updates"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.config_updates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id5"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.token_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id6"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.config_updates</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.HttpRequestCallable"><code class="docutils literal notranslate"><span class="pre">HttpRequestCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.AuthRefreshCallback"><code class="docutils literal notranslate"><span class="pre">AuthRefreshCallback</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.CustomAuthPrepareCallable"><code class="docutils literal notranslate"><span class="pre">CustomAuthPrepareCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.CustomLogFormatter"><code class="docutils literal notranslate"><span class="pre">CustomLogFormatter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.CustomLogHandler"><code class="docutils literal notranslate"><span class="pre">CustomLogHandler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.CustomRedactionRule"><code class="docutils literal notranslate"><span class="pre">CustomRedactionRule</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.RequestHookCallable"><code class="docutils literal notranslate"><span class="pre">RequestHookCallable</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#apiconfig.types.ResponseHookCallable"><code class="docutils literal notranslate"><span class="pre">ResponseHookCallable</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/types.html#auth-refresh-types">Auth Refresh Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#id7"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id8"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.access_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id9"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.refresh_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id10"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.expires_in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id11"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.token_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id12"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.scope</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id13"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.access_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id14"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.refresh_token</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id15"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.expires_in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id16"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.token_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id17"><code class="docutils literal notranslate"><span class="pre">RefreshedTokenData.scope</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#id18"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id19"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.token_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id20"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.config_updates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id21"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.token_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id22"><code class="docutils literal notranslate"><span class="pre">TokenRefreshResult.config_updates</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/types.html#type-aliases">Type Aliases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id23"><code class="docutils literal notranslate"><span class="pre">HttpRequestCallable</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id24"><code class="docutils literal notranslate"><span class="pre">AuthRefreshCallback</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/types.html#id25"><code class="docutils literal notranslate"><span class="pre">ResponseBodyType</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">apiconfig</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">apiconfig.testing.auth_verification</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for apiconfig.testing.auth_verification</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># File: apiconfig/testing/auth_verification.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Authentication verification utilities for testing.</span>

<span class="sd">This module provides comprehensive utilities for verifying authentication headers</span>
<span class="sd">and formats in tests, supporting Basic Auth, Bearer tokens, API keys, and advanced</span>
<span class="sd">verification scenarios like JWT and OAuth2 tokens.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">apiconfig.exceptions.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">AuthenticationError</span>


<div class="viewcode-block" id="AuthHeaderVerification">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AuthHeaderVerification</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utilities for verifying authentication headers in tests.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="AuthHeaderVerification.verify_basic_auth_header">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_basic_auth_header">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_basic_auth_header</span><span class="p">(</span>
        <span class="n">header_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">expected_username</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">expected_password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify Basic Auth header format and optionally credentials.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        header_value : str</span>
<span class="sd">            The Authorization header value</span>
<span class="sd">        expected_username : str, optional</span>
<span class="sd">            Expected username to validate against</span>
<span class="sd">        expected_password : str, optional</span>
<span class="sd">            Expected password to validate against</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if header is valid Basic auth format</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If header format is invalid or credentials don&#39;t match</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_basic_auth_header(&quot;Basic dGVzdDpwYXNz&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_basic_auth_header(</span>
<span class="sd">        ...     &quot;Basic dGVzdDpwYXNz&quot;, &quot;test&quot;, &quot;pass&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">header_value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Basic &quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Basic auth header must start with &#39;Basic &#39;&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">encoded_credentials</span> <span class="o">=</span> <span class="n">header_value</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>  <span class="c1"># Remove &quot;Basic &quot;</span>
            <span class="n">decoded_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encoded_credentials</span><span class="p">)</span>
            <span class="n">decoded_str</span> <span class="o">=</span> <span class="n">decoded_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">decoded_str</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Basic auth credentials must contain &#39;:&#39;&quot;</span><span class="p">)</span>

            <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="n">decoded_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">expected_username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">username</span> <span class="o">!=</span> <span class="n">expected_username</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected username &#39;</span><span class="si">{</span><span class="n">expected_username</span><span class="si">}</span><span class="s2">&#39;, got &#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">expected_password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">!=</span> <span class="n">expected_password</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Password does not match expected value&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnicodeDecodeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Basic auth encoding: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AuthHeaderVerification.verify_bearer_auth_header">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_bearer_auth_header">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_bearer_auth_header</span><span class="p">(</span>
        <span class="n">header_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">expected_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">token_pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify Bearer Auth header format and optionally token value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        header_value : Optional[str]</span>
<span class="sd">            The Authorization header value</span>
<span class="sd">        expected_token : str, optional</span>
<span class="sd">            Expected token value to validate against</span>
<span class="sd">        token_pattern : str, optional</span>
<span class="sd">            Regex pattern for token validation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if header is valid Bearer auth format</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If header format is invalid or token doesn&#39;t match</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_bearer_auth_header(&quot;Bearer abc123&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_bearer_auth_header(</span>
<span class="sd">        ...     &quot;Bearer abc123&quot;, expected_token=&quot;abc123&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">header_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Bearer auth header cannot be None&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Bearer auth header must be a string&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">header_value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Bearer &quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Bearer auth header must start with &#39;Bearer &#39;&quot;</span><span class="p">)</span>

        <span class="n">token</span> <span class="o">=</span> <span class="n">header_value</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span>  <span class="c1"># Remove &quot;Bearer &quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Bearer token cannot be empty&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expected_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">token</span> <span class="o">!=</span> <span class="n">expected_token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected token &#39;</span><span class="si">{</span><span class="n">expected_token</span><span class="si">}</span><span class="s2">&#39;, got &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">token_pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">token_pattern</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token does not match pattern &#39;</span><span class="si">{</span><span class="n">token_pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="AuthHeaderVerification.verify_api_key_header">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_api_key_header">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_api_key_header</span><span class="p">(</span>
        <span class="n">header_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">expected_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">key_pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify API Key header format and optionally key value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        header_value : str</span>
<span class="sd">            The API key header value</span>
<span class="sd">        expected_key : str, optional</span>
<span class="sd">            Expected key value to validate against</span>
<span class="sd">        key_pattern : str, optional</span>
<span class="sd">            Regex pattern for key validation</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if header is valid API key format</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If header format is invalid or key doesn&#39;t match</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_api_key_header(&quot;sk-123abc&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_api_key_header(</span>
<span class="sd">        ...     &quot;sk-123abc&quot;, expected_key=&quot;sk-123abc&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">header_value</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;API key header cannot be empty&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expected_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">header_value</span> <span class="o">!=</span> <span class="n">expected_key</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected key &#39;</span><span class="si">{</span><span class="n">expected_key</span><span class="si">}</span><span class="s2">&#39;, got &#39;</span><span class="si">{</span><span class="n">header_value</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">key_pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">key_pattern</span><span class="p">,</span> <span class="n">header_value</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;API key does not match pattern &#39;</span><span class="si">{</span><span class="n">key_pattern</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="AuthHeaderVerification.verify_auth_header_format">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_auth_header_format">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_auth_header_format</span><span class="p">(</span>
        <span class="n">headers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">auth_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">header_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Authorization&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify auth header exists and has correct format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        headers : Dict[str, str]</span>
<span class="sd">            Request headers dictionary</span>
<span class="sd">        auth_type : str</span>
<span class="sd">            Type of auth (&quot;basic&quot;, &quot;bearer&quot;, &quot;api_key&quot;)</span>
<span class="sd">        header_name : str, default &quot;Authorization&quot;</span>
<span class="sd">            Header name to check</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional arguments for specific verification methods</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If header is missing or invalid</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; headers = {&quot;Authorization&quot;: &quot;Bearer abc123&quot;}</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_auth_header_format(headers, &quot;bearer&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">header_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing </span><span class="si">{</span><span class="n">header_name</span><span class="si">}</span><span class="s2"> header&quot;</span><span class="p">)</span>

        <span class="n">header_value</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="n">header_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">auth_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;basic&quot;</span><span class="p">:</span>
            <span class="n">AuthHeaderVerification</span><span class="o">.</span><span class="n">verify_basic_auth_header</span><span class="p">(</span><span class="n">header_value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">auth_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bearer&quot;</span><span class="p">:</span>
            <span class="n">AuthHeaderVerification</span><span class="o">.</span><span class="n">verify_bearer_auth_header</span><span class="p">(</span><span class="n">header_value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">auth_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;api_key&quot;</span><span class="p">:</span>
            <span class="n">AuthHeaderVerification</span><span class="o">.</span><span class="n">verify_api_key_header</span><span class="p">(</span><span class="n">header_value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported auth type: </span><span class="si">{</span><span class="n">auth_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AuthHeaderVerification.verify_multiple_auth_headers">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_multiple_auth_headers">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_multiple_auth_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">auth_configs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify multiple authentication headers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        headers : Dict[str, str]</span>
<span class="sd">            Request headers dictionary</span>
<span class="sd">        auth_configs : List[Dict[str, Union[str, Dict]]]</span>
<span class="sd">            List of auth configurations, each containing:</span>
<span class="sd">            - auth_type: Type of auth</span>
<span class="sd">            - header_name: Header name</span>
<span class="sd">            - **kwargs: Additional verification arguments</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; headers = {</span>
<span class="sd">        ...     &quot;Authorization&quot;: &quot;Bearer abc123&quot;,</span>
<span class="sd">        ...     &quot;X-API-Key&quot;: &quot;key123&quot;</span>
<span class="sd">        ... }</span>
<span class="sd">        &gt;&gt;&gt; configs = [</span>
<span class="sd">        ...     {&quot;auth_type&quot;: &quot;bearer&quot;, &quot;header_name&quot;: &quot;Authorization&quot;},</span>
<span class="sd">        ...     {&quot;auth_type&quot;: &quot;api_key&quot;, &quot;header_name&quot;: &quot;X-API-Key&quot;, &quot;expected_key&quot;: &quot;key123&quot;}</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_multiple_auth_headers(headers, configs)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">auth_configs</span><span class="p">:</span>
            <span class="n">config_copy</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">auth_type</span> <span class="o">=</span> <span class="n">config_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;auth_type&quot;</span><span class="p">)</span>
            <span class="n">header_name</span> <span class="o">=</span> <span class="n">config_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;header_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Authorization&quot;</span><span class="p">)</span>
            <span class="n">AuthHeaderVerification</span><span class="o">.</span><span class="n">verify_auth_header_format</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth_type</span><span class="p">,</span> <span class="n">header_name</span><span class="p">,</span> <span class="o">**</span><span class="n">config_copy</span><span class="p">)</span></div>


<div class="viewcode-block" id="AuthHeaderVerification.verify_no_auth_headers">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthHeaderVerification.verify_no_auth_headers">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_no_auth_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">auth_header_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify that no authentication headers are present.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        headers : Dict[str, str]</span>
<span class="sd">            Request headers dictionary</span>
<span class="sd">        auth_header_names : List[str], optional</span>
<span class="sd">            List of auth header names to check (default: common auth headers)</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If any auth headers are found</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; headers = {&quot;Content-Type&quot;: &quot;application/json&quot;}</span>
<span class="sd">        &gt;&gt;&gt; AuthHeaderVerification.verify_no_auth_headers(headers)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auth_header_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">auth_header_names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;Authorization&quot;</span><span class="p">,</span>
                <span class="s2">&quot;X-API-Key&quot;</span><span class="p">,</span>
                <span class="s2">&quot;X-Auth-Token&quot;</span><span class="p">,</span>
                <span class="s2">&quot;X-Access-Token&quot;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="n">found_headers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">header_name</span> <span class="ow">in</span> <span class="n">auth_header_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header_name</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
                <span class="n">found_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">found_headers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected auth headers found: </span><span class="si">{</span><span class="n">found_headers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="AdvancedAuthVerification">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AdvancedAuthVerification</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Advanced authentication verification utilities.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="AdvancedAuthVerification.verify_jwt_structure">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification.verify_jwt_structure">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_jwt_structure</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verify_signature</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify JWT token structure and optionally signature.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        token : str</span>
<span class="sd">            JWT token string</span>
<span class="sd">        verify_signature : bool, default False</span>
<span class="sd">            Whether to verify signature (requires key)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, Any]</span>
<span class="sd">            Dictionary containing header and payload</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If JWT structure is invalid</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; token = &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ&quot;</span>
<span class="sd">        &gt;&gt;&gt; result = AdvancedAuthVerification.verify_jwt_structure(token)</span>
<span class="sd">        &gt;&gt;&gt; &quot;header&quot; in result and &quot;payload&quot; in result</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;JWT must have exactly 3 parts&quot;</span><span class="p">)</span>

            <span class="n">header_b64</span><span class="p">,</span> <span class="n">payload_b64</span><span class="p">,</span> <span class="n">signature_b64</span> <span class="o">=</span> <span class="n">parts</span>

            <span class="c1"># Decode header and payload</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">header_b64</span> <span class="o">+</span> <span class="s2">&quot;==&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">payload_b64</span> <span class="o">+</span> <span class="s2">&quot;==&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>

            <span class="c1"># Basic structure validation</span>
            <span class="k">if</span> <span class="s2">&quot;alg&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;JWT header missing &#39;alg&#39; field&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;typ&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span> <span class="ow">or</span> <span class="n">header</span><span class="p">[</span><span class="s2">&quot;typ&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;JWT&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;JWT header &#39;typ&#39; must be &#39;JWT&#39;&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">,</span> <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">}</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid JWT structure: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AdvancedAuthVerification.verify_oauth2_token_format">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification.verify_oauth2_token_format">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_oauth2_token_format</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">token_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Bearer&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify OAuth2 token format and characteristics.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        token : str</span>
<span class="sd">            OAuth2 token string</span>
<span class="sd">        token_type : str, default &quot;Bearer&quot;</span>
<span class="sd">            Expected token type</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if token format is valid</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If token format is invalid</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; AdvancedAuthVerification.verify_oauth2_token_format(&quot;abc123token&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;OAuth2 token cannot be empty&quot;</span><span class="p">)</span>

        <span class="c1"># Check for common OAuth2 token patterns</span>
        <span class="k">if</span> <span class="n">token_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bearer&quot;</span><span class="p">:</span>
            <span class="c1"># Bearer tokens are typically base64-encoded or JWT</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Bearer token appears too short&quot;</span><span class="p">)</span>

            <span class="c1"># Check if it&#39;s a JWT</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">AdvancedAuthVerification</span><span class="o">.</span><span class="n">verify_jwt_structure</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="AdvancedAuthVerification.verify_session_token_format">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AdvancedAuthVerification.verify_session_token_format">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_session_token_format</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify session token format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        token : str</span>
<span class="sd">            Session token string</span>
<span class="sd">        expected_prefix : str, optional</span>
<span class="sd">            Expected token prefix</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if token format is valid</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AuthenticationError</span>
<span class="sd">            If token format is invalid</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; AdvancedAuthVerification.verify_session_token_format(&quot;sess_abc123&quot;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; AdvancedAuthVerification.verify_session_token_format(</span>
<span class="sd">        ...     &quot;sess_abc123&quot;, expected_prefix=&quot;sess_&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Session token cannot be empty&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expected_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">expected_prefix</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Session token must start with &#39;</span><span class="si">{</span><span class="n">expected_prefix</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># Basic length validation</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Session token appears too short&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>
</div>



<div class="viewcode-block" id="AuthTestHelpers">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AuthTestHelpers</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper utilities for auth testing scenarios.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="AuthTestHelpers.assert_auth_applied">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers.assert_auth_applied">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assert_auth_applied</span><span class="p">(</span><span class="n">headers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">auth_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">verification_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert that authentication was properly applied to headers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        headers : Dict[str, str]</span>
<span class="sd">            Request headers to verify</span>
<span class="sd">        auth_type : str</span>
<span class="sd">            Expected auth type</span>
<span class="sd">        **verification_kwargs</span>
<span class="sd">            Additional verification arguments</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AssertionError</span>
<span class="sd">            If authentication was not properly applied</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; headers = {&quot;Authorization&quot;: &quot;Bearer abc123&quot;}</span>
<span class="sd">        &gt;&gt;&gt; AuthTestHelpers.assert_auth_applied(headers, &quot;bearer&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">AuthHeaderVerification</span><span class="o">.</span><span class="n">verify_auth_header_format</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">auth_type</span><span class="p">,</span> <span class="o">**</span><span class="n">verification_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">AuthenticationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authentication not properly applied: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AuthTestHelpers.assert_no_auth_applied">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers.assert_no_auth_applied">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assert_no_auth_applied</span><span class="p">(</span><span class="n">headers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assert that no authentication was applied to headers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        headers : Dict[str, str]</span>
<span class="sd">            Request headers to verify</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AssertionError</span>
<span class="sd">            If unexpected authentication was found</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; headers = {&quot;Content-Type&quot;: &quot;application/json&quot;}</span>
<span class="sd">        &gt;&gt;&gt; AuthTestHelpers.assert_no_auth_applied(headers)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">AuthHeaderVerification</span><span class="o">.</span><span class="n">verify_no_auth_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">AuthenticationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected authentication found: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="AuthTestHelpers.create_test_auth_headers">
<a class="viewcode-back" href="../../../api/testing.html#apiconfig.testing.AuthTestHelpers.create_test_auth_headers">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_test_auth_headers</span><span class="p">(</span><span class="n">auth_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create test authentication headers for testing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auth_type : str</span>
<span class="sd">            Type of auth to create</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Auth-specific parameters</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, str]</span>
<span class="sd">            Dictionary with appropriate auth headers</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; headers = AuthTestHelpers.create_test_auth_headers(&quot;basic&quot;)</span>
<span class="sd">        &gt;&gt;&gt; &quot;Authorization&quot; in headers</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; headers = AuthTestHelpers.create_test_auth_headers(</span>
<span class="sd">        ...     &quot;api_key&quot;, key=&quot;mykey&quot;, header_name=&quot;X-API-Key&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; headers[&quot;X-API-Key&quot;]</span>
<span class="sd">        &#39;mykey&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">auth_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;basic&quot;</span><span class="p">:</span>
            <span class="n">username</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;testuser&quot;</span><span class="p">)</span>
            <span class="n">password</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;testpass&quot;</span><span class="p">)</span>
            <span class="n">credentials</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Basic </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">elif</span> <span class="n">auth_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bearer&quot;</span><span class="p">:</span>
            <span class="n">token</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="s2">&quot;test_bearer_token&quot;</span><span class="p">)</span>
            <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">elif</span> <span class="n">auth_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;api_key&quot;</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;test_api_key&quot;</span><span class="p">)</span>
            <span class="n">header_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header_name&quot;</span><span class="p">,</span> <span class="s2">&quot;X-API-Key&quot;</span><span class="p">)</span>
            <span class="n">headers</span><span class="p">[</span><span class="n">header_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

        <span class="k">return</span> <span class="n">headers</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Leikaab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>